{"version":3,"sources":["node_modules/browser-pack/_prelude.js","public/javascripts/index.js","public/javascripts/user-edit.js","public/javascripts/user-form.js","public/javascripts/user-validator.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","handleUsername","handlePassword","handleConfirmPassword","handleName","enableEditing","subscribeIfCan","node","event","callback","addEventListener","document","querySelector","_userValidator","getEditInputs","handleApprovement","body","username","_getEditInputs3","_getEditInputs4","_slicedToArray","firstName","lastName","validateName","value","innerHTML","fetch","method","headers","accept","content-type","JSON","stringify","then","res","ok","json","Array","isArray","succeedRequest","catch","failedRequest","data","style","display","setAttribute","errors","console","log","btn","approveBtn","_getEditInputs","_getEditInputs2","removeAttribute","createElement","classList","add","appendChild","preventDefault","validateUsername","validatePassword","validateConfirmPassword","validateInput","validator","error","target","setCustomValidity","text","newError","errorBox","firstChild","removeChild","removeAllNodes","password","confirmPasswordInput","test","p1","p2","name"],"mappings":"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","file":"main.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","const {handleUsername, handlePassword,\n\thandleConfirmPassword, handleName} = require('./user-form');\nconst {enableEditing} = require('./user-edit');\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\t// User form\n\tconst usernameInput = document.querySelector('input[name=username]');\n\tsubscribeIfCan(usernameInput, 'input', handleUsername);\n\n\tconst password = document.querySelector('input[name=password]');\n\tsubscribeIfCan(password, 'input', handlePassword);\n\n\tconst cPassword = document.querySelector('input[name=confirmPassword]');\n\tsubscribeIfCan(cPassword, 'input', handleConfirmPassword);\n\n\tconst firstName = document.querySelector('input[name=firstName]');\n\tsubscribeIfCan(firstName, 'input', handleName);\n\n\tconst lastName = document.querySelector('input[name=lastName]');\n\tsubscribeIfCan(lastName, 'input', handleName);\n\n\n\t// User edit\n\tconst editButton = document.querySelector('.edit-button');\n\tsubscribeIfCan(editButton, 'click', enableEditing);\n});\n\nfunction subscribeIfCan(node, event, callback) {\n\tif (node) {\n\t\tnode.addEventListener(event, callback);\n\t}\n};\n","import {validateName} from './user-validator';\n\n\nexports.enableEditing = function(event) {\n\tconst [firstName, lastName] = getEditInputs();\n\tfirstName.removeAttribute('disabled');\n\tlastName.removeAttribute('disabled');\n\n\tconst editButton = document.querySelector('.edit-button');\n\teditButton.style.display = 'none';\n\n\tif (!document.querySelector('.approve-button')) {\n\t\taddApproveButton(createApproveButton());\n\t} else {\n\t\tdocument.querySelector('.approve-button')\n\t\t\t.style.display = 'block';\n\t}\n\n\tevent.preventDefault();\n};\n\nfunction getEditInputs() {\n\treturn [\n\t\tdocument.querySelector('input[name=firstName]'),\n\t\tdocument.querySelector('input[name=lastName]'),\n\t];\n}\n\nfunction addApproveButton(btn) {\n\tconst addUserForm = document.querySelector('.manager-container');\n\taddUserForm.appendChild(btn);\n}\n\nfunction createApproveButton() {\n\tconst approveBtn = document.createElement('button');\n\tapproveBtn.classList.add(\n\t\t'pure-button', 'button-success', 'approve-button');\n\tapproveBtn.innerHTML = 'Підтвердити';\n\tapproveBtn.addEventListener('click', handleApprovement);\n\treturn approveBtn;\n}\n\nfunction handleApprovement(event) {\n\tconst [firstName, lastName] = getEditInputs();\n\tconst isNamesValid = \n\t\t!validateName(firstName.value) &&\n\t\t!validateName(lastName.value);\n\tif (isNamesValid) {\n\t\trequestForChanges({\n\t\t\tfirstName: firstName.value,\n\t\t\tlastName: lastName.value,\n\t\t}).then(succeedRequest)\n\t\t\t.catch(failedRequest);\n\t}\n}\n\nfunction succeedRequest(data) {\n\tconst approveBtn = document.querySelector('.approve-button');\n\tapproveBtn.style.display = 'none';\n\tconst editButton = document.querySelector('.edit-button');\n\teditButton.style.display = 'block';\n\tconst firstName = document.querySelector('input[name=firstName]');\n\tconst lastName = document.querySelector('input[name=lastName]');\n\tfirstName.setAttribute('disabled', true);\n\tlastName.setAttribute('disabled', true);\n};\n\nfunction failedRequest(errors) {\n\tconsole.log('this is errors: ', errors);\n};\n\n/**\n * @param {JSON} body\n * @return {Promise}\n */\nfunction requestForChanges(body) {\n\tconst username = getCurrentUsername();\n\treturn fetch(`/dashboard/managers/${username}`, {\n\t\tmethod: 'PUT',\n\t\theaders: {\n\t\t\t'accept': 'application/json',\n\t\t\t'content-type': 'application/json',\n\t\t},\n\t\tbody: JSON.stringify(body),\n\t}).then(function(res) {\n\t\tif (res.ok) {\n\t\t\treturn res.json();\n\t\t}\n\t\tthrow new Error('Network response failed.');\n\t}).then(function(json) {\n\t\tif (Array.isArray(json)) {\n\t\t\tthrow new Error(json);\n\t\t}\n\t\treturn json;\n\t});\n}\n\nfunction getCurrentUsername() {\n\tconst result = document.querySelector('.username').innerHTML;\n\treturn result;\n}\n","const {validateUsername, validatePassword,\n\tvalidateConfirmPassword, validateName} = require('./user-validator');\n\nexports.handleUsername = validateInput(validateUsername);\n\nexports.handlePassword = validateInput(validatePassword);\n\nexports.handleConfirmPassword = validateInput(confirmPasswordValidatorWrapper);\n\nexports.handleName = validateInput(validateName);\n\nfunction validateInput(validator) {\n\treturn function(event) {\n\t\tconst error = validator(event.target.value);\n\t\tevent.target.setCustomValidity(error || '');\n\t\tconst errorBox = document.querySelector('.errors');\n\t\tremoveAllNodes(errorBox);\n\t\tif (error) {\n\t\t\terrorBox.appendChild(createError(error));\n\t\t}\n\t};\n};\n\nfunction confirmPasswordValidatorWrapper(password) {\n\tconst confirmPasswordInput = document.querySelector(\n\t\t'input[name=password]');\n\treturn validateConfirmPassword(password,\n\t\tconfirmPasswordInput.value);\n};\n\n\nfunction removeAllNodes(node) {\n\twhile (node.firstChild) {\n\t\tnode.removeChild(node.firstChild);\n\t}\n};\n\nfunction createError(text) {\n\tconst newError = document.createElement('span');\n\tnewError.classList.add('form__error');\n\tnewError.innerHTML = text;\n\treturn newError;\n};\n\n","exports.validateUsername = function(username) {\n\tconst legalChars = /[\\w\\u0403-\\u04FF]/g;\n\n\tif (username == '') {\n\t\treturn 'Please enter username';\n\t}\n\tif ((username.length < 3) || (username.length > 15)) {\n\t\treturn 'Username must have 3-15 characters';\n\t}\n\tif (!legalChars.test(username)) {\n\t\treturn 'Use only numbers and alphabets for username';\n\t}\n};\n\nexports.validatePassword = function(password) {\n\tif (password.length < 5) {\n\t\treturn 'Password should contain at least 5 symbols';\n\t}\n};\n\nexports.validateConfirmPassword = function(p1, p2) {\n\tif (p1 !== p2) {\n\t\treturn 'Passwords should match';\n\t}\n};\n\nexports.validateName = function(name) {\n\tif (!name) {\n\t\treturn;\n\t}\n\tconst firstUpper = /^[A-Z\\u0403-\\u042F]/;\n\tif (!firstUpper.test(name)) {\n\t\treturn 'Name shoud start from capital.';\n\t}\n\tconst legalCharacters = /[A-z\\u0403-\\u04FF\\'\\-]+$/;\n\tif (!legalCharacters.test(name)) {\n\t\treturn 'Name could only contain alphabet and \\' \\-';\n\t}\n};\n\n"]}